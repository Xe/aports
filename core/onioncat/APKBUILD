# Contributor: Christine Dodrill <me@christine.website>
# Maintainer: Christine Dodrill <me@christine.website>
pkgname=onioncat
pkgver=0.2.2.r578
pkgrel=3
pkgdesc="An IP-Transparent Tor Hidden Service Connector"
url="https://www.onioncat.org"
arch="all"
license="gpl3"
depends="tor"
makedepends=""
install="$pkgname.pre-install $pkgname.post-install"
subpackages="$pkgname-doc"
source="
	onioncat.initd
	onioncat.confd
	https://www.cypherpunk.at/ocat/download/Source/current/onioncat-${pkgver}.tar.gz
	"
builddir="$srcdir/onioncat-0.2.2.r578"

build() {
	cd "$builddir"
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var
	echo '#define _PATH_HOSTS "/etc/hosts"' >> config.h.in
	make
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" install

	install -m755 -D "$srcdir"/$pkgname.initd \
		"$pkgdir"/etc/init.d/$pkgname
	install -m644 -D "$srcdir"/$pkgname.confd \
		"$pkgdir"/etc/conf.d/$pkgname
}

sha512sums="4bed238a4cc334c40bd16bb9436538d1eb9f48f8009d57efaae242e88c68fd496307cb1316f19d0ca96776aa514d4decc664812455fb38730b0d796ebb438df8  onioncat.initd
df5ebef92689b5a1faa5801dc8acb557295d2d3c4bbbdcfedfddf57576e8bbccb5fc0564f38bbd8672c4ae793c32b13be3e127a125ad66c49a8351eda2052bb3  onioncat.confd
a6638a582e321ce1969ac70d73c52b828e1dfb0ca25ee33a18c811d5a972603bff8ff510a1b833259ea4184843dc6d1e2c2892809ca437180d79e0bbd4a79bb6  onioncat-0.2.2.r578.tar.gz"
