# Contributor: Christine Dodrill <me@christine.website>
# Maintainer: Christine Dodrill <me@christine.website>
pkgname=route-mesh
pkgver=0.2.0
pkgrel=0
pkgdesc="HTTP routing mesh"
url="https://info.route.xeserv.us"
arch="x86_64"
license="MIT"
depends="ca-certificates"
makedepends=""
install=""
subpackages="$pkgname-runit:runit $pkgname-server:routed $pkgname-agent:agent"
source="
        run

        https://xena.greedo.xeserv.us/pkg/bin/route-v0.2-linux.tar.gz
       "
builddir="$srcdir/"
_builddir="$srcdir/"

build() {
	echo "nothing to do"
}

package() {
	install -D -m 755 "$srcdir"/route-cli "$pkgdir"/usr/bin/route-cli
}

routed() {
	cd "$_builddir"
	pkgdesc="$pkgname daemon"
	depends=""               

	install -D -m 755 "$srcdir"/routed "$subpkgdir"/usr/bin/routed
}

agent() {
	cd "$_builddir"
	pkgdesc="$pkgname agent"

	install -D -m 755 "$srcdir"/route-httpagent "$subpkgdir"/usr/bin/route-httpagent
}

runit() {
	cd "$_builddir"
	pkgdesc="$pkgname agent runit bindings"
	depends="$pkgname-agent runit"
	source="run"

	install -D -m 755 "$srcdir"/run "$subpkgdir"/etc/system/$pkgname/run 
}

sha512sums="fabce2527312bd679e45cd23029b750d26d33adc32a9635b262d443f4ac5bcec40c3694efdba1c70fc1d38e1dc7001cb4ab3c2f39c73adfde0fe53ca20320fda  run
b27ce21e573617bc587044f06483e8550ba725e52ae3e2d1d5ccbc32fa4600299d5dad3838710693bbe0c7bad0a24ecbf5886db06039160a39ef25ce77633f76  route-v0.2-linux.tar.gz"
